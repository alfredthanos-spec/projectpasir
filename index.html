<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Project Pasir</title>

<style>
body {
  font-family: Arial, sans-serif;
  margin: 20px;
  background: #f4f4f4;
}

h1 {
  text-align: center;
}

.info {
  text-align: center;
  margin-bottom: 20px;
  font-weight: bold;
}

table {
  width: 100%;
  border-collapse: collapse;
  background: white;
}

th, td {
  border: 1px solid #ccc;
  padding: 8px;
  text-align: center;
}

th {
  background: #e0e0e0;
}

input {
  width: 90%;
  text-align: center;
  padding: 4px;
}

.summary {
  margin-top: 20px;
  padding: 15px;
  background: white;
  border: 1px solid #ccc;
  font-weight: bold;
}

button {
  margin-top: 10px;
  padding: 8px 15px;
  cursor: pointer;
}
</style>
</head>

<body>

<h1>PROJECT PASIR</h1>

<div class="info">
  <div id="tanggal"></div>
  <div id="bulan"></div>
  <div id="minggu"></div>
</div>

<table>
<thead>
<tr>
<th>Jenis</th>
<th>Rit</th>
<th>Harga / Rit</th>
<th>Total</th>
</tr>
</thead>
<tbody id="tabelBody">
<tr>
<td>Pasir</td>
<td><input type="number" id="rit1"></td>
<td><input type="number" id="harga1" maxlength="7"></td>
<td id="total1">0</td>
</tr>
<tr>
<td>Batu</td>
<td><input type="number" id="rit2"></td>
<td><input type="number" id="harga2" maxlength="7"></td>
<td id="total2">0</td>
</tr>
<tr>
<td>Tanah</td>
<td><input type="number" id="rit3"></td>
<td><input type="number" id="harga3" maxlength="7"></td>
<td id="total3">0</td>
</tr>
</tbody>
</table>

<div class="summary">
Total Semua: Rp <span id="grandTotal">0</span>
</div>

<button onclick="simpanData()">Simpan Minggu Ini</button>

<script>

// ===== TANGGAL & BULAN =====
const today = new Date();
const options = { day: '2-digit', month: 'long', year: 'numeric' };

document.getElementById("tanggal").innerHTML =
"Tanggal: " + today.toLocaleDateString("id-ID", options);

const bulanNama = today.toLocaleString("id-ID", { month: "long" });
document.getElementById("bulan").innerHTML = "Bulan: " + bulanNama;

// ===== MINGGU (MAX 4) =====
let mingguKe = Math.ceil(today.getDate() / 7);
if (mingguKe > 4) mingguKe = 4;

document.getElementById("minggu").innerHTML =
"Minggu ke-" + mingguKe;

// ===== HITUNG TOTAL =====
function hitung() {
  let grand = 0;

  for (let i = 1; i <= 3; i++) {
    let rit = document.getElementById("rit"+i).value || 0;
    let harga = document.getElementById("harga"+i).value || 0;

    let total = rit * harga;
    document.getElementById("total"+i).innerHTML =
      total.toLocaleString("id-ID");

    grand += total;
  }

  document.getElementById("grandTotal").innerHTML =
    grand.toLocaleString("id-ID");
}

// ===== BATASI MAX 7 DIGIT =====
for (let i = 1; i <= 3; i++) {
  document.getElementById("harga"+i)
    .addEventListener("input", function() {
      if (this.value.length > 7) {
        this.value = this.value.slice(0,7);
      }
      hitung();
  });

  document.getElementById("rit"+i)
    .addEventListener("input", hitung);
}

// ===== SIMPAN PER MINGGU =====
function simpanData() {
  const data = {
    rit1: rit1.value,
    harga1: harga1.value,
    rit2: rit2.value,
    harga2: harga2.value,
    rit3: rit3.value,
    harga3: harga3.value
  };

  localStorage.setItem("minggu"+mingguKe, JSON.stringify(data));
  alert("Data minggu ke-" + mingguKe + " tersimpan!");
}

// ===== LOAD DATA SAAT BUKA =====
window.onload = function() {
  const saved = localStorage.getItem("minggu"+mingguKe);
  if (saved) {
    const data = JSON.parse(saved);
    rit1.value = data.rit1;
    harga1.value = data.harga1;
    rit2.value = data.rit2;
    harga2.value = data.harga2;
    rit3.value = data.rit3;
    harga3.value = data.harga3;
    hitung();
  }
};

</script>

</body>
</html>
