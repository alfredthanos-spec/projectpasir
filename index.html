<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Project Pasir</title>

<style>
body {
  font-family: Arial, sans-serif;
  margin: 20px;
  background: #f4f4f4;
}

h1 {
  text-align: center;
}

.info {
  text-align: center;
  margin-bottom: 20px;
  font-weight: bold;
}

table {
  width: 100%;
  border-collapse: collapse;
  background: white;
}

th, td {
  border: 1px solid #ccc;
  padding: 8px;
  text-align: center;
}

th {
  background: #e0e0e0;
}

input {
  text-align: center;
  padding: 4px;
}

.harga-input {
  width: 100px;
}

.summary {
  margin-top: 20px;
  padding: 15px;
  background: white;
  border: 1px solid #ccc;
  font-weight: bold;
}
</style>
</head>

<body>

<h1>PROJECT PASIR</h1>

<div class="info">
  <div id="tanggal"></div>
  <div id="bulan"></div>
  <div id="minggu"></div>
</div>

<table>
<thead>
<tr>
<th>Jenis</th>
<th>Rit</th>
<th>Harga / Rit</th>
<th>Total</th>
</tr>
</thead>

<tbody>
<tr>
<td>Pasir</td>
<td><input type="number" id="rit1"></td>
<td><input type="text" id="harga1" class="harga-input"></td>
<td id="total1">0</td>
</tr>

<tr>
<td>Batu</td>
<td><input type="number" id="rit2"></td>
<td><input type="text" id="harga2" class="harga-input"></td>
<td id="total2">0</td>
</tr>

<tr>
<td>Tanah</td>
<td><input type="number" id="rit3"></td>
<td><input type="text" id="harga3" class="harga-input"></td>
<td id="total3">0</td>
</tr>

</tbody>
</table>

<div class="summary">
Total Semua: Rp <span id="grandTotal">0</span>
</div>

<script>

// ===== TANGGAL & BULAN =====
const today = new Date();
const options = { day: '2-digit', month: 'long', year: 'numeric' };

document.getElementById("tanggal").innerHTML =
"Tanggal: " + today.toLocaleDateString("id-ID", options);

document.getElementById("bulan").innerHTML =
"Bulan: " + today.toLocaleString("id-ID", { month: "long" });

let mingguKe = Math.ceil(today.getDate() / 7);
if (mingguKe > 4) mingguKe = 4;

document.getElementById("minggu").innerHTML =
"Minggu ke-" + mingguKe;


// ===== FORMAT RUPIAH =====
function formatRupiah(angka) {
  return angka.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
}

function getNumber(value) {
  return Number(value.replace(/\./g, ""));
}


// ===== HITUNG TOTAL =====
function hitung() {
  let grand = 0;

  for (let i = 1; i <= 3; i++) {

    let rit = document.getElementById("rit"+i).value || 0;

    let hargaInput = document.getElementById("harga"+i);
    let harga = getNumber(hargaInput.value || "0");

    let total = rit * harga;

    document.getElementById("total"+i).innerHTML =
      formatRupiah(total);

    grand += total;
  }

  document.getElementById("grandTotal").innerHTML =
    formatRupiah(grand);
}


// ===== BATASI 7 DIGIT + FORMAT OTOMATIS =====
for (let i = 1; i <= 3; i++) {

  let hargaInput = document.getElementById("harga"+i);

  hargaInput.addEventListener("input", function() {

    let angka = this.value.replace(/\D/g, "");

    if (angka.length > 7) {
      angka = angka.slice(0,7);
    }

    this.value = formatRupiah(angka);
    hitung();
  });

  document.getElementById("rit"+i)
    .addEventListener("input", hitung);
}

</script>

</body>
</html>
